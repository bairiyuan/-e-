<!--pages/intervention/intervention.wxml-->
<view class="intervention-container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <text class="header-title">ä¸ªæ€§åŒ–å¹²é¢„æ–¹æ¡ˆ</text>
    <text class="header-desc">åŸºäºæ‚¨çš„é£é™©è¯„ä¼°ç»“æœåˆ¶å®š</text>
  </view>

  <!-- é£é™©è¯„ä¼°ç»“æœ -->
  <view class="assessment-result" wx:if="{{latestAssessment}}">
    <view class="result-card {{latestAssessment.level}}">
      <text class="result-title">æœ€æ–°è¯„ä¼°ç»“æœ</text>
      <view class="result-info">
        <text class="result-level">{{latestAssessment.levelName}}</text>
        <text class="result-score">å¾—åˆ†ï¼š{{latestAssessment.totalScore}}</text>
      </view>
      <text class="result-date">{{latestAssessment.date}}</text>
    </view>
  </view>

  <!-- æ— è¯„ä¼°è®°å½•æç¤º -->
  <view class="no-assessment" wx:if="{{!latestAssessment}}">
    <view class="empty-state">
      <text class="empty-icon">ğŸ“Š</text>
      <text class="empty-text">æš‚æ— è¯„ä¼°è®°å½•</text>
      <text class="empty-desc">è¯·å…ˆå®Œæˆé£é™©è¯„ä¼°è·å–ä¸ªæ€§åŒ–æ–¹æ¡ˆ</text>
      <button class="assessment-btn" bindtap="goToAssessment">å¼€å§‹è¯„ä¼°</button>
    </view>
  </view>

  <!-- å¹²é¢„æ–¹æ¡ˆå†…å®¹ -->
  <view class="intervention-content" wx:if="{{latestAssessment}}">
    <!-- é¥®é£Ÿå»ºè®® -->
    <view class="plan-section">
      <view class="section-header">
        <text class="section-icon">ğŸ</text>
        <text class="section-title">é¥®é£Ÿå»ºè®®</text>
      </view>
      <view class="plan-list">
        <block wx:for="{{dietPlan}}" wx:key="id">
          <view class="plan-item">
            <text class="plan-icon">âœ“</text>
            <text class="plan-text">{{item.content}}</text>
          </view>
        </block>
      </view>
    </view>

    <!-- è¿åŠ¨æ–¹æ¡ˆ -->
    <view class="plan-section">
      <view class="section-header">
        <text class="section-icon">ğŸƒ</text>
        <text class="section-title">è¿åŠ¨æ–¹æ¡ˆ</text>
      </view>
      <view class="plan-list">
        <block wx:for="{{exercisePlan}}" wx:key="id">
          <view class="plan-item">
            <text class="plan-icon">âœ“</text>
            <text class="plan-text">{{item.content}}</text>
          </view>
        </block>
      </view>
    </view>

    <!-- ç”Ÿæ´»ä¹ æƒ¯ -->
    <view class="plan-section">
      <view class="section-header">
        <text class="section-icon">ğŸŒ</text>
        <text class="section-title">ç”Ÿæ´»ä¹ æƒ¯</text>
      </view>
      <view class="plan-list">
        <block wx:for="{{lifestylePlan}}" wx:key="id">
          <view class="plan-item">
            <text class="plan-icon">âœ“</text>
            <text class="plan-text">{{item.content}}</text>
          </view>
        </block>
      </view>
    </view>

    <!-- äº§å“æ¨è -->
    <view class="plan-section">
      <view class="section-header">
        <text class="section-icon">ğŸ’Š</text>
        <text class="section-title">äº§å“æ¨è</text>
      </view>
      <view class="product-recommendation">
        <view class="product-card" bindtap="goToProduct">
          <view class="product-image">
            <text class="image-placeholder">ğŸ’Š</text>
          </view>
          <view class="product-info">
            <text class="product-name">éª¨å›ºå…ƒä¹Œè¯å£æœæ¶²</text>
            <text class="product-desc">ç§‘å­¦é…æ–¹ï¼Œä¸“ä¸šæŠ¤éª¨ï¼Œé€‚åˆ{{latestAssessment.levelName}}äººç¾¤</text>
            <view class="product-price">
              <text class="current-price">Â¥198</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç›‘æµ‹å»ºè®® -->
    <view class="plan-section">
      <view class="section-header">
        <text class="section-icon">ğŸ“‹</text>
        <text class="section-title">ç›‘æµ‹å»ºè®®</text>
      </view>
      <view class="plan-list">
        <block wx:for="{{monitoringPlan}}" wx:key="id">
          <view class="plan-item">
            <text class="plan-icon">ğŸ“…</text>
            <text class="plan-text">{{item.content}}</text>
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="action-section" wx:if="{{latestAssessment}}">
    <button class="save-btn" bindtap="savePlan">ä¿å­˜æ–¹æ¡ˆ</button>
    <button class="share-btn" bindtap="sharePlan">åˆ†äº«æ–¹æ¡ˆ</button>
  </view>
</view>